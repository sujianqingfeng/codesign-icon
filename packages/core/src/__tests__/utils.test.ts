import type { IconsItem } from '../types'
import { promises as fs } from 'fs'
import { describe, test, expect } from 'vitest'
import {
  createMaxIntervalFn,
  fetchCodesignIcons,
  fetchToken,
  generateKey,
  generateQrCode,
  isColors,
  parseIcons
} from '../utils'

describe('utils', () => {
  test('generateKey', () => {
    const key = generateKey()
    expect(key.length).toBe(16)
  })

  test.skip('parseIcons', () => {
    const icons: IconsItem[] = [
      // {
      //   name: 'uni-more',
      //   svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 24" class="1p6ls6n49__design-iconfont">\n  <path d="M3.10449 10.1208H6.86281V13.8792H3.10449V10.1208ZM10.6211 10.1208H14.3794V13.8792H10.6211V10.1208ZM21.8961 10.1208H18.1378V13.8792H21.8961V10.1208Z"></path>\n</svg>',
      //   class_name: 'uni-more'
      // },
    ]
    const data = parseIcons(icons, {
      prefix: 'base'
    })

    expect(data).toMatchInlineSnapshot()
  })

  test.skip('save file', async () => {
    const text = await fs.readFile('icons.json', 'utf8')
    // const icons: IconsItem[] = [
    //   {
    //     name: '\u65fa\u98ce\u63a7',
    //     svg: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 32 32" class="design-iconfont">\n  <path d="M6.82867 17.9751C6.20358 18.6545 5.42681 19.1347 4.49835 19.4156C4.48901 19.4186 4.47918 19.4196 4.46942 19.4186C4.45967 19.4176 4.4502 19.4146 4.44156 19.4099C4.43293 19.4051 4.42531 19.3987 4.41915 19.3909C4.41299 19.3832 4.40842 19.3743 4.40571 19.3647C3.24106 15.0441 2.07946 10.7198 0.920919 6.39172C0.693554 5.54266 0.51811 4.91215 0.394586 4.50018C0.392728 4.49383 0.392151 4.48717 0.39289 4.4806C0.393629 4.47402 0.395668 4.46766 0.398889 4.46188C0.402111 4.4561 0.406449 4.45102 0.411653 4.44694C0.416857 4.44285 0.422821 4.43984 0.4292 4.43808L15.3467 0.455465C15.3532 0.453744 15.36 0.453301 15.3666 0.454164C15.3733 0.455026 15.3797 0.457176 15.3854 0.460489C15.3912 0.463802 15.3962 0.468212 15.4003 0.473466C15.4043 0.478719 15.4072 0.484712 15.4088 0.491096C15.7163 1.71411 15.5954 2.88352 15.0464 3.9993C14.5482 5.01124 13.8254 5.77037 12.8779 6.27668C12.5203 6.46739 11.8806 6.68933 10.9589 6.94248C9.58589 7.31984 8.19896 7.69245 6.79813 8.0603C6.78595 8.0635 6.77453 8.06907 6.76451 8.07668C6.75449 8.0843 6.74607 8.09382 6.73973 8.10469C6.7334 8.11557 6.72927 8.12759 6.72758 8.14006C6.7259 8.15253 6.72669 8.16521 6.72992 8.17738C7.11338 9.60876 7.49345 11.0239 7.87013 12.4227C8.09886 13.2737 8.21932 13.911 8.23154 14.3346C8.27091 15.7015 7.80328 16.915 6.82867 17.9751Z" fill="#0DDBFF"></path>\n  <path d="M25.6054 18.3898C24.4916 17.4288 23.8812 16.216 23.7739 14.7513C23.7407 14.3013 23.7872 13.8357 23.9134 13.3545C24.3668 11.6232 24.8229 9.89284 25.2817 8.16351C25.2835 8.15711 25.2839 8.1504 25.2831 8.14379C25.2822 8.13718 25.28 8.13079 25.2766 8.12501C25.2731 8.11922 25.2686 8.11415 25.2632 8.1101C25.2578 8.10605 25.2516 8.10309 25.245 8.10141C24.0573 7.76952 22.8682 7.44375 21.6778 7.12408C20.507 6.80984 19.8537 6.62625 19.718 6.57331C18.5072 6.10433 17.6045 5.28209 17.01 4.10658C16.4446 2.9874 16.3038 1.78542 16.5875 0.50064C16.5894 0.492691 16.5929 0.485203 16.5977 0.47862C16.6026 0.472037 16.6087 0.466492 16.6157 0.462315C16.6227 0.458138 16.6305 0.455414 16.6386 0.454303C16.6467 0.453191 16.6549 0.453716 16.6628 0.455847L31.5681 4.4405C31.5816 4.44409 31.5931 4.45283 31.6001 4.46484C31.6072 4.47684 31.6092 4.49114 31.6058 4.50463L27.611 19.3784C27.6081 19.3886 27.6033 19.3981 27.5968 19.4064C27.5902 19.4148 27.5821 19.4217 27.5729 19.4268C27.5637 19.4319 27.5536 19.4352 27.5432 19.4363C27.5327 19.4374 27.5222 19.4364 27.5122 19.4333C26.8023 19.2223 26.1667 18.8744 25.6054 18.3898Z" fill="#0859F8"></path>\n  <path d="M18.2243 21.9945C18.7055 21.5167 19.1884 21.0413 19.673 20.5682C20.2506 20.0035 20.9082 19.5987 21.646 19.3537C22.2833 19.1426 22.9525 19.0639 23.6536 19.1175C24.8542 19.2091 25.9157 19.6842 26.838 20.5428C26.849 20.553 26.8555 20.5672 26.8563 20.5822C26.857 20.5971 26.852 20.6119 26.8421 20.6232C26.515 20.991 26.1794 21.3467 25.8353 21.6901C22.5463 24.9771 19.2505 28.2572 15.9479 31.5306C15.9431 31.5354 15.9374 31.5393 15.9311 31.542C15.9248 31.5446 15.9181 31.5461 15.9114 31.5462C15.9047 31.5463 15.8981 31.545 15.8919 31.5425C15.8858 31.54 15.8803 31.5363 15.8757 31.5316C12.3994 28.0702 8.92543 24.6072 5.45388 21.1424C5.28284 20.972 5.13998 20.8146 5.02528 20.67C5.00355 20.6426 4.99332 20.6079 4.99674 20.573C5.00015 20.538 5.01695 20.5057 5.0436 20.4827C5.72298 19.899 6.46039 19.4976 7.25583 19.2783C7.90534 19.0998 8.57759 19.0581 9.27258 19.1531C10.1854 19.278 11.0036 19.6187 11.7271 20.1752C11.8805 20.294 12.3712 20.762 13.1992 21.5791C14.0937 22.4635 14.9879 23.3482 15.8818 24.2332C15.8912 24.2427 15.9041 24.248 15.9176 24.248C15.9311 24.248 15.9442 24.2427 15.9541 24.2332C16.7135 23.4893 17.4703 22.7431 18.2243 21.9945Z" fill="#4C545C"></path>\n</svg>',
    //     class_name: 'wangfengqiang'
    //   },
    //   {
    //     name: '404',
    //     svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 276 174" class="design-iconfont">\n  <path d="M101.313 15.2155C100.905 15.3607 100.455 15.1515 100.305 14.7462L98.3626 9.53182C98.1558 9.15293 98.2921 8.67862 98.6688 8.46659C99.0748 8.32484 99.5204 8.52896 99.6771 8.92844L101.619 14.1428C101.831 14.5234 101.694 15.0033 101.313 15.2155Z" fill="#C1C6D6"></path>\n  <path d="M98.2583 9.97865C99.735 9.97865 100.932 8.78469 100.932 7.31187C100.932 5.83904 99.735 4.64508 98.2583 4.64508C96.7816 4.64508 95.5845 5.83904 95.5845 7.31187C95.5845 8.78469 96.7816 9.97865 98.2583 9.97865Z" fill="#8E97B1"></path>\n  <path d="M48.0059 93.8994L62.5173 94.0131L62.1447 141.336L47.6332 141.222L48.0059 93.8994Z" fill="url(#s38dh9ape__paint0_linear_2168_18297)"></path>\n  <path d="M200.727 106.783L215.239 106.897L214.866 154.219L200.354 154.106L200.727 106.783Z" fill="url(#s38dh9ape__paint1_linear_2168_18297)"></path>\n  <path d="M122.172 104.746L164.595 105.169L164.026 161.954L121.603 161.531L122.172 104.746Z" fill="url(#s38dh9ape__paint2_linear_2168_18297)"></path>\n  <path d="M117.709 62.5564C135.319 56.8888 146.044 41.2594 141.663 27.6472C137.282 14.035 119.454 7.59455 101.844 13.2621C84.2339 18.9297 73.5094 34.5591 77.8903 48.1714C82.2712 61.7836 100.099 68.224 117.709 62.5564Z" fill="#E5E8F4" opacity=".6"></path>\n  <g opacity=".8" fill="#fff">\n    <path d="M84.5458 48.9451C80.2513 35.641 90.73 20.3703 107.953 14.8356C113.292 13.0918 118.937 12.4828 124.526 13.0478C117.158 11.048 109.36 11.2736 102.12 13.6959C84.8894 19.2231 74.4106 34.4938 78.7052 47.8054C81.5882 56.7444 90.4014 62.5174 101.112 63.6795C93.12 61.3628 86.8836 56.1931 84.5458 48.9451Z"></path>\n    <path d="M117.533 62.0103C134.755 56.4678 145.243 41.1843 140.959 27.8737C136.676 14.5631 119.242 8.2658 102.02 13.8083C84.7988 19.3508 74.3106 34.6343 78.5944 47.9449C82.8783 61.2555 100.312 67.5528 117.533 62.0103Z"></path>\n  </g>\n  <path d="M111.172 36.3487L140.211 60.6701L238 108.21L38 164.801L98.8933 73.639L111.172 36.3487Z" fill="url(#s38dh9ape__paint3_linear_2168_18297)"></path>\n  <path d="M96.6924 70.0873L139.223 56.4357L140.591 60.6761L98.0607 74.3277L96.6924 70.0873Z" fill="#C1C6D6" fill-opacity=".66" opacity=".8"></path>\n  <path d="M96.4697 69.3778L139 55.7262L140.368 59.9666L97.838 73.6182L96.4697 69.3778Z" fill="#8E97B1"></path>\n  <path d="M118.58 65.2302C154.197 53.7674 180.647 36.9458 177.658 27.6581C174.669 18.3704 143.373 20.1337 107.756 31.5965C72.1389 43.0593 45.6888 59.8808 48.6779 69.1685C51.667 78.4562 82.9634 76.693 118.58 65.2302Z" fill="url(#s38dh9ape__paint4_linear_2168_18297)" opacity=".8"></path>\n  <path d="M107.968 32.125C73.5214 43.1869 47.9407 59.4334 50.8386 68.4096L175.568 28.3631C172.7 19.3795 142.421 21.063 107.968 32.125Z" fill="#EFF0F5"></path>\n  <path d="M118.469 64.6404C152.915 53.5859 178.496 37.3394 175.598 28.3557L50.8687 68.4096C53.7367 77.3858 84.0003 75.7023 118.469 64.6404Z" fill="#fff"></path>\n  <path d="M118.469 64.6404C152.915 53.5859 178.496 37.3394 175.598 28.3557L50.8687 68.4096C53.7367 77.3858 84.0003 75.7023 118.469 64.6404Z" fill="#C1C6D6"></path>\n  <path d="M86.2743 52.3663L137.333 35.9772C139.677 35.2247 142.188 36.5128 142.944 38.8558C143.698 41.1941 142.414 43.7013 140.076 44.4558C140.074 44.4565 140.072 44.4572 140.07 44.4579L89.0109 60.8471C86.6668 61.5995 84.1562 60.3114 83.4001 57.9685C82.6456 55.6302 83.9295 53.1229 86.2678 52.3684C86.2699 52.3677 86.2721 52.367 86.2743 52.3663Z" fill="#8E97B1"></path>\n  <g opacity=".5" fill="#fff">\n    <path d="M127.879 73.855C127.592 74.362 127.766 75.0054 128.27 75.2993C128.774 75.5932 129.422 75.4285 129.724 74.9297C130.025 74.4308 129.869 73.7828 129.373 73.4751C129.126 73.3218 128.827 73.2757 128.545 73.3474C128.263 73.4191 128.023 73.6024 127.879 73.855Z"></path>\n    <path d="M117.499 81.4605C117.211 81.9675 117.385 82.611 117.889 82.9048C118.394 83.1987 119.041 83.034 119.343 82.5352C119.644 82.0363 119.488 81.3884 118.992 81.0806C118.745 80.9273 118.446 80.8812 118.164 80.9529C117.882 81.0246 117.642 81.2079 117.499 81.4605Z"></path>\n    <path d="M137.732 82.6524C137.444 83.1594 137.618 83.8028 138.123 84.0967C138.627 84.3905 139.274 84.2259 139.576 83.727C139.878 83.2282 139.722 82.5802 139.226 82.2725C138.979 82.1192 138.68 82.073 138.398 82.1447C138.116 82.2164 137.875 82.3998 137.732 82.6524Z"></path>\n    <path d="M148.928 78.4212C148.738 78.7081 148.723 79.0756 148.887 79.3773C149.051 79.6791 149.369 79.8662 149.713 79.8641C150.058 79.862 150.373 79.671 150.533 79.3672C150.766 78.9278 150.611 78.3839 150.182 78.1312C149.754 77.8786 149.201 78.0062 148.928 78.4212Z"></path>\n    <path d="M127.73 68.8938C127.596 69.0914 127.584 69.3465 127.697 69.5562C127.811 69.7658 128.032 69.8952 128.271 69.8922C128.509 69.8892 128.727 69.7543 128.835 69.5419C128.989 69.24 128.881 68.871 128.588 68.6994C128.295 68.5278 127.919 68.613 127.73 68.8938Z"></path>\n    <path d="M124.213 80.9167C124.034 81.2232 124.137 81.6167 124.445 81.7957C124.752 81.9746 125.146 81.8712 125.326 81.5647C125.505 81.2582 125.402 80.8647 125.094 80.6857C124.787 80.5068 124.392 80.6102 124.213 80.9167Z"></path>\n    <path d="M118.253 72.3055C118.064 72.5924 118.048 72.9599 118.212 73.2616C118.377 73.5634 118.694 73.7505 119.038 73.7484C119.383 73.7462 119.698 73.5553 119.859 73.2515C120.091 72.8121 119.936 72.2682 119.508 72.0155C119.079 71.7629 118.527 71.8905 118.253 72.3055Z"></path>\n    <path d="M105.884 84.8648C105.683 85.152 105.66 85.5277 105.826 85.8368C105.991 86.146 106.317 86.3363 106.668 86.3292C107.02 86.3221 107.337 86.1189 107.49 85.8033C107.752 85.359 107.603 84.7871 107.158 84.5258C106.712 84.2646 106.139 84.413 105.877 84.8573L105.884 84.8648Z"></path>\n  </g>\n  <path d="M119.853 88.8394C120.515 88.8446 121.048 89.3855 121.042 90.0475C121.042 90.0475 121.042 90.0475 121.042 90.0475L120.991 96.6185C120.985 97.2806 120.445 97.813 119.783 97.8078C119.121 97.8026 118.588 97.2618 118.593 96.5997C118.593 96.5997 118.593 96.5997 118.593 96.5997L118.645 90.0287C118.65 89.3666 119.191 88.8342 119.853 88.8394Z" fill="#C1C6D6"></path>\n  <path d="M132.438 92.9484C132.856 93.4581 132.782 94.2103 132.272 94.6285C132.272 94.6291 132.271 94.6298 132.27 94.6304L127.165 98.7964C126.652 99.2147 125.898 99.1392 125.478 98.6278C125.06 98.1181 125.134 97.3659 125.644 96.9477C125.645 96.9471 125.646 96.9464 125.647 96.9458L130.752 92.7798C131.264 92.3615 132.019 92.437 132.438 92.9484Z" fill="#C1C6D6"></path>\n  <path d="M113.501 99.0396C113.054 99.5267 112.296 99.5596 111.808 99.1132L106.946 94.6682C106.459 94.2233 106.425 93.4682 106.87 92.9815C106.871 92.9808 106.872 92.98 106.872 92.9792C107.32 92.4921 108.078 92.4592 108.566 92.9056L113.428 97.3505C113.914 97.7954 113.948 98.5506 113.503 99.0372C113.503 99.038 113.502 99.0388 113.501 99.0396Z" fill="#C1C6D6"></path>\n  <path d="M147.83 99.3672C149.333 99.379 150.542 100.607 150.531 102.111C150.531 102.111 150.531 102.111 150.531 102.111L150.34 126.291C150.328 127.794 149.1 129.003 147.597 128.991C146.093 128.98 144.884 127.751 144.896 126.248C144.896 126.248 144.896 126.248 144.896 126.248L145.086 102.068C145.098 100.565 146.326 99.3554 147.83 99.3672Z" fill="#8E97B1" fill-opacity=".48"></path>\n  <path d="M129.957 120.471C129.981 118.972 131.216 117.773 132.72 117.79L146.164 117.887C147.664 117.911 148.862 119.139 148.845 120.635C148.837 121.356 148.542 122.043 148.025 122.547C147.508 123.05 146.812 123.327 146.089 123.317L132.645 123.22C131.146 123.192 129.948 121.967 129.957 120.471Z" fill="#8E97B1" fill-opacity=".48"></path>\n  <path d="M131.352 122.892C130.71 122.545 130.234 121.955 130.031 121.256C129.828 120.556 129.913 119.804 130.269 119.168L136.685 107.346C137.034 106.706 137.625 106.231 138.326 106.028C139.028 105.825 139.782 105.911 140.419 106.266C141.736 106.989 142.217 108.639 141.495 109.953L135.049 121.85C134.314 123.151 132.663 123.617 131.352 122.892Z" fill="#8E97B1" fill-opacity=".48"></path>\n  <path d="M100.522 99.8607C102.026 99.8757 103.233 101.107 103.217 102.61C103.217 102.61 103.217 102.61 103.217 102.61L102.975 126.791C102.96 128.294 101.729 129.501 100.225 129.486C98.7219 129.471 97.5153 128.24 97.5303 126.736C97.5303 126.736 97.5303 126.736 97.5303 126.736L97.7727 102.556C97.7878 101.052 99.0189 99.8456 100.522 99.8607Z" fill="#8E97B1" fill-opacity=".48"></path>\n  <path d="M85.8673 120.121C85.8919 118.622 87.1268 117.423 88.6308 117.44L102.112 117.537C103.612 117.561 104.81 118.789 104.794 120.285C104.785 121.006 104.49 121.693 103.973 122.197C103.456 122.7 102.76 122.977 102.037 122.967L88.5935 122.87C87.8659 122.868 87.1691 122.577 86.6574 122.061C86.1457 121.545 85.8614 120.847 85.8673 120.121Z" fill="#8E97B1" fill-opacity=".48"></path>\n  <path d="M87.2649 122.542C86.6229 122.195 86.1471 121.605 85.9436 120.906C85.7402 120.206 85.826 119.454 86.1819 118.818L92.5976 106.996C93.3229 105.683 94.9766 105.203 96.2947 105.923C97.611 106.647 98.092 108.296 97.3702 109.611L90.962 121.432C90.6201 122.069 90.038 122.544 89.3444 122.753C88.6507 122.961 87.9025 122.885 87.2649 122.542Z" fill="#8E97B1" fill-opacity=".48"></path>\n  <path d="M125.572 102.638C124.044 104.365 121.815 105.31 119.508 105.208C117.212 105.271 115.012 104.286 113.533 102.534C111.915 104.098 110.997 106.246 110.986 108.493L110.896 119.444C110.859 124.158 114.661 128.01 119.388 128.047C124.115 128.084 127.978 124.292 128.015 119.578L128.104 108.627C128.098 106.374 127.186 104.217 125.572 102.638ZM122.383 119.496C122.214 121.073 120.873 122.265 119.282 122.252C117.692 122.238 116.371 121.024 116.229 119.444L116.296 111.25C116.463 109.672 117.803 108.478 119.394 108.49C120.984 108.502 122.306 109.714 122.451 111.294L122.383 119.496Z" fill="#8E97B1" fill-opacity=".48"></path>\n  <path d="M166.776 163.305L164.814 163.305L163.881 155.737H166.776L166.776 163.305Z" fill="#FFCEC4"></path>\n  <path d="M166.999 162.447L166.485 162.664L164.682 162.11L164.109 162.804C162.749 162.804 160.667 162.942 160.667 164.302C160.667 165.662 164.907 165.095 166.308 165.095C167.243 165.095 167.473 164.212 166.999 162.447Z" fill="#8E97B1"></path>\n  <path d="M184.504 160.754L182.748 161.629L178.537 155.272L181.128 153.981L184.504 160.754Z" fill="#FFCEC4"></path>\n  <path d="M184.666 159.957L184.172 160.204L181.851 160.381L181.52 161.787C180.303 162.394 178.537 164.511 179.995 164.891C181.454 165.272 184.875 163.116 185.568 162.336C186.03 161.815 185.73 161.023 184.666 159.957Z" fill="#8E97B1"></path>\n  <path d="M165.907 128.934L178.382 129.26L178.165 135.335C178.165 135.335 178.382 136.962 177.948 137.396C177.514 137.83 177.297 137.83 177.514 138.589C177.731 139.348 178.292 146.604 178.292 146.604C178.292 146.604 183.412 155.657 183.195 155.874C182.978 156.091 182.761 155.874 182.978 156.416C183.195 156.959 183.412 156.742 183.195 156.959C183.003 157.166 182.822 157.383 182.652 157.61H179.116C179.116 157.61 178.919 156.525 178.919 156.416C178.919 156.308 178.702 155.657 178.702 155.549C178.702 155.44 172.524 148.895 172.524 148.895L171.222 138.047L168.076 148.678C168.076 148.678 168.076 158.007 167.859 158.224C167.642 158.441 167.642 158.332 167.751 158.766C167.859 159.2 168.293 159.092 167.968 159.417C167.642 159.743 167.534 159.2 167.642 159.743L167.751 160.285L163.583 160.331C163.583 160.331 163.149 159.417 163.366 159.092C163.583 158.766 163.57 158.855 163.305 158.322C163.041 157.79 162.932 157.681 163.041 157.573C163.149 157.464 163.149 156.887 163.149 156.887C163.149 156.887 164.713 135.552 164.713 135.226C164.721 135.059 164.691 134.892 164.623 134.738V134.297L165.039 132.731L165.907 128.934Z" fill="#C1C6D6"></path>\n  <path d="M154.799 98.5339C154.488 99.4037 154.932 100.362 155.797 100.688C155.889 100.722 155.983 100.748 156.08 100.766L157.041 106.648L159.294 104.567L158.036 99.3005C158.133 98.3771 157.47 97.547 156.549 97.4369C155.781 97.3489 155.054 97.8044 154.799 98.5339L154.799 98.5339Z" fill="#FFCEC4"></path>\n  <path d="M171.429 111.862C171.429 111.862 169.68 109.551 163.334 109.614L159.732 108.305L158.908 100.759L156.027 101.445L156.439 110.775L162.613 114.342L170.708 115.989L171.429 111.862Z" fill="#fff"></path>\n  <path opacity=".1" d="M169.598 110.506L167.737 114.214L167.108 115.242L166.639 115.039L167.108 109.982L169.598 110.506Z" fill="#69718A"></path>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M174 106.274L173.176 109.471L170.656 108.862L171.173 106.274H174Z" fill="#FFCEC4"></path>\n  <path d="M172.358 107.047C170.278 107.047 168.592 105.361 168.592 103.281C168.592 101.2 170.278 99.514 172.358 99.514C174.439 99.514 176.125 101.2 176.125 103.281C176.125 105.361 174.439 107.047 172.358 107.047Z" fill="#FFDCD5"></path>\n  <path d="M178.733 131.841C178.74 131.841 178.344 131.843 178.35 131.841C178.42 131.822 178.878 131.804 178.627 129.634L178.356 127.918L178.62 126.404L179.065 125.959L178.35 125.244L177.75 123.54L178.788 122.002L179.561 116.774C179.982 114.542 178.716 111.577 176.67 110.593L174.989 109.857C174.097 108.674 173.451 108.081 173.052 108.078L171.384 108.059C170.868 108.055 170.67 107.965 170.355 108.374L169.185 109.847L167.107 115.058L166.138 124.133C165.944 124.296 165.827 124.533 165.815 124.786C165.803 125.04 165.898 125.286 166.076 125.466C166.114 125.505 166.144 125.536 166.163 125.556C166.225 125.644 166.109 126.297 165.966 126.851L165.783 127.7C165.902 127.785 165.98 127.915 165.998 128.06C166.016 128.205 165.973 128.351 165.878 128.462L165.645 128.737C165.549 129.457 166.053 130.118 166.772 130.216C170.109 130.67 178.716 131.841 178.733 131.841Z" fill="#fff"></path>\n  <path opacity=".1" d="M178.352 122.139L176.125 129.607L175.495 130.45L176.125 122.139L174.989 115.989L178.352 122.139Z" fill="#69718A"></path>\n  <path d="M177.611 100.152C177.358 99.7451 176.743 99.2141 176.46 98.8272C176.427 98.7761 177.024 98.3346 176.981 98.2711C176.936 98.2046 176.25 98.5162 176.213 98.4645C176.176 98.412 176.482 98.0264 176.415 97.9872C176.338 97.9418 176.049 98.2438 176.002 98.1855C175.649 97.8393 175.184 97.6276 174.69 97.5879C173.604 97.4651 173.004 97.1705 171.666 97.6552C170.328 98.1398 168.381 99.8899 168.521 100.152C168.661 100.414 169.958 100.581 169.929 100.988C169.924 101.063 170.121 101.228 170.229 101.263C170.556 101.366 170.902 100.852 171.225 101.434C171.549 102.016 171.462 101.936 171.666 102.119C171.918 102.345 172.307 102.285 172.638 102.359C173.234 102.514 173.524 103.135 173.648 102.988C173.777 102.839 174.143 102.496 174.546 102.879C175.369 103.606 173.962 106.128 173.962 106.128C174.205 106.284 174.372 106.72 174.806 106.385C175.095 106.161 175.531 105.726 176.114 105.078C177.1 104.26 177.679 103.519 177.85 102.853C178.069 102.007 178.073 100.897 177.611 100.152Z" fill="#8E97B1"></path>\n  <path d="M176.266 137.243C177.015 136.703 177.193 135.662 176.665 134.903C176.609 134.823 176.545 134.748 176.476 134.679L179.018 129.288L175.982 129.725L174.034 134.777C173.43 135.483 173.506 136.543 174.203 137.156C174.786 137.663 175.643 137.7 176.266 137.243L176.266 137.243Z" fill="#FFCEC4"></path>\n  <path d="M177.036 134.3L180.73 125.21L180.771 118.03C180.488 117.168 180.275 116.522 180.134 116.091C179.992 115.66 179.896 115.014 179.846 114.152C179.496 113.089 178.732 112.213 177.726 111.722C176.721 111.231 175.559 111.168 174.507 111.547L174.478 111.557L174.467 111.585C174.42 111.695 173.35 114.34 176.522 119.781L177.16 123.504L174.921 132.038L177.036 134.3Z" fill="#fff"></path>\n  <defs>\n    <linearGradient id="s38dh9ape__paint0_linear_2168_18297" x1="54.9043" y1="140.176" x2="54.9033" y2="94.9923" gradientUnits="userSpaceOnUse">\n      <stop stop-color="#fff" stop-opacity="0"></stop>\n      <stop offset="1" stop-color="#C1C6D6" stop-opacity=".27"></stop>\n    </linearGradient>\n    <linearGradient id="s38dh9ape__paint1_linear_2168_18297" x1="207.625" y1="153.06" x2="207.625" y2="107.876" gradientUnits="userSpaceOnUse">\n      <stop stop-color="#fff" stop-opacity="0"></stop>\n      <stop offset="1" stop-color="#C1C6D6" stop-opacity=".27"></stop>\n    </linearGradient>\n    <linearGradient id="s38dh9ape__paint2_linear_2168_18297" x1="142.847" y1="160.42" x2="143.214" y2="106.2" gradientUnits="userSpaceOnUse">\n      <stop stop-color="#fff" stop-opacity="0"></stop>\n      <stop offset="1" stop-color="#C1C6D6" stop-opacity=".27"></stop>\n    </linearGradient>\n    <linearGradient id="s38dh9ape__paint3_linear_2168_18297" x1="92.2161" y1="2.33526" x2="119.114" y2="147.887" gradientUnits="userSpaceOnUse">\n      <stop stop-color="#CCC"></stop>\n      <stop offset=".15" stop-color="#D7D7D7" stop-opacity=".79"></stop>\n      <stop offset=".37" stop-color="#E5E5E5" stop-opacity=".51"></stop>\n      <stop offset=".57" stop-color="#F0F0F0" stop-opacity=".29"></stop>\n      <stop offset=".75" stop-color="#F8F8F8" stop-opacity=".13"></stop>\n      <stop offset=".9" stop-color="#FDFDFD" stop-opacity=".03"></stop>\n      <stop offset="1" stop-color="#fff" stop-opacity="0"></stop>\n    </linearGradient>\n    <linearGradient id="s38dh9ape__paint4_linear_2168_18297" x1="118.583" y1="65.2373" x2="107.756" y2="31.5965" gradientUnits="userSpaceOnUse">\n      <stop stop-color="#C1C6D6" stop-opacity=".3"></stop>\n      <stop offset="1" stop-color="#8E97B1" stop-opacity=".17"></stop>\n    </linearGradient>\n  </defs>\n</svg>',
    //     class_name: '404'
    //   }
    // ]
    const icons = JSON.parse(text)
    const data = parseIcons(icons, {
      prefix: 'base'
    })
    const exported = `${JSON.stringify(data, null, '\t')}\n`
    await fs.writeFile(`base.json`, exported, 'utf8')
  })

  test.skip('transform', async () => {
    const text = await fs.readFile('icons.json', 'utf8')
    const icons = JSON.parse(text)
    const d = icons.map((item) => ({
      name: item.name,
      svg: item.svg,
      class_name: item.class_name
    }))
    const exported = `${JSON.stringify(d, null, '\t')}\n`
    await fs.writeFile(`icons.json`, exported, 'utf8')
  })

  test.skip(
    'download icon json',
    async () => {
      const key = generateKey()
      const url = `https://codesign.qq.com/login/${key}`
      generateQrCode(url)

      const token = (await createMaxIntervalFn<string | null>({
        fn: async () => {
          console.log('fetching token...')
          return fetchToken(key)
        }
      })) as string

      console.log('token:', token)

      const icons = await fetchCodesignIcons({
        project_id: 'lnGaV96la6ZPqwd',
        team_id: 'qxWyZ1ybLDZmVXk',
        include: 'creator',
        per_page: 500,
        page: 1,
        Authorization: `Bearer ${token}`
      })

      const exported = `${JSON.stringify(icons.data, null, '\t')}\n`
      await fs.writeFile(`icons.json`, exported, 'utf8')
    },
    { timeout: 200000 }
  )

  test('isColors', () => {
    const svg =
      '<path fill="#C1C6D6" d="M101.313 15.216a.79.79 0 01-1.008-.47l-1.942-5.214a.79.79 0 01.306-1.065.8.8 0 011.008.461l1.942 5.215c.212.38.075.86-.306 1.072"/><path fill="#8E97B1" d="M98.258 9.979a2.67 2.67 0 002'
    expect(isColors(svg)).toBeTruthy()
  })
})
